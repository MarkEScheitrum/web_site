<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Genealogy Records</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 40px;
            text-align: center;
            position: relative;
            min-height: 100vh;
        }
        h1 {
            color: #333;
        }
        a {
            font-size: 18px;
            color: #0066cc;
            text-decoration: none;
        }
        a:hover {
            text-decoration: underline;
        }
        #issue-submission {
            position: absolute;
            bottom: 20px;
            right: 20px;
            width: 300px;
            background: #f9f9f9;
            padding: 15px;
            border: 1px solid #ccc;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        #issue-submission h3 {
            margin: 0 0 10px;
            font-size: 16px;
            color: #333;
        }
        #issue-form {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        #issue-title, #issue-body {
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 3px;
            font-family: Arial, sans-serif;
        }
        #issue-body {
            resize: vertical;
            min-height: 80px;
        }
        #issue-form button {
            padding: 8px;
            background: #0066cc;
            color: white;
            border: none;
            border-radius: 3px;
            cursor: pointer;
        }
        #issue-form button:hover {
            background: #0055aa;
        }
        #issue-feedback {
            font-size: 14px;
            margin-top: 10px;
        }
        .photo-frame {
            display: inline-block;
            margin: 20px;
            padding: 10px;
            background: #f9f9f9;
            border: 1px solid #ccc;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            text-align: center;
        }
        .photo-frame img {
            max-width: 600px;
            max-height: 600px;
            border-radius: 3px;
        }
        .photo-frame p {
            margin: 10px 0 0;
            font-size: 14px;
            color: #333;
        }
        .instructions {
            text-align: left;
            max-width: 800px;
            margin: 16px auto;
            padding: 16px;
            background: #f9f9f9;
            border: 1px solid #ccc;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .instructions h2 {
            color: #333;
            font-size: 16px;
            margin-bottom: 15px;
        }
        .instructions ol {
            padding-left: 16px;
        }
        .instructions li {
            margin-bottom: 10px;
            line-height: 1.5;
        }
        .instructions ul {
            padding-left: 20px;
        }
        .instructions strong {
            color: #0066cc;
        }
        .version-legend {
            position: absolute;
            bottom: 20px;
            left: 20px;
            font-size: 12px;
            color: #666;
            background: #f9f9f9;
            padding: 5px 10px;
            border: 1px solid #ccc;
            border-radius: 3px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        @media (max-width: 600px) {
            #issue-submission {
                position: static;
                width: 100%;
                margin-top: 20px;
            }
            .photo-frame {
                margin: 10px;
            }
            .photo-frame img {
                max-width: 100%;
                max-height: 400px;
            }
            .photo-frame p {
                font-size: 12px;
            }
            .instructions {
                padding: 15px;
            }
            .version-legend {
                position: static;
                margin: 10px auto;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <h1>Welcome to the Leiby Genealogy Recorder</h1>
    <div class="photo-frame">
        <img src="img/tabernacle bridge2.jpg" alt="Tabernacle Bridge circa 1960">
        <p>Tabernacle Bridge, Lewistown Valley, Tamaqua PA circa 1960</p>
    </div>
    <div class="instructions">
        <h2>How to Use the Genealogy Recorder</h2>
        <ol>
            <li>Save the attached encrypted records file from the email to your <strong>Downloads folder</strong> on your computer.</li>
            <li>Click this <a href="recorder4.html" id="openEditorLink" aria-label="Open genealogy editor in a new window or focus existing one"><strong>Genealogy Recorder</strong></a> link to open the recorder page.</li>
            <li>In the recorder, click the <strong>"Select/Load File"</strong> button and use your file finder to select the file saved in step 1.</li>
            <li>When the <strong>Passphrase dialog box</strong> appears, enter the <strong>Passphrase</strong> from the email. It is <strong>case sensitive</strong>.</li>
            <li>Edit records with this guidance:
                <ul>
                    <li><strong>View Table</strong> to see the current extracted information (from the Leiby Genealogy Book, 2016 edition).</li>
                    <li>Use the <strong>action buttons</strong> to add spouses/partners, children, or record deaths as needed.</li>
                    <li>Use the <strong>"Update Record"</strong> button to fix typos or omissions in editable fields.</li>
                </ul>
            </li>
            <li>Review the resulting changes in the table.</li>
            <li>If satisfied, click the <strong>"Return Updates"</strong> button. This generates a file in your <strong>Downloads folder</strong> and composes an email to me. If no email is created, follow the instructions to do it manually in your email app.</li>
            <li>Attach the edited file from your <strong>Downloads folder</strong> to the email and send it.</li>
            <li>Feedback welcome! Use the <strong>Report an Issue</strong> form to share issues or suggest improvements.</li>
        </ol>
    </div>
    <p id="popupWarning" style="display:none;color:red;">Please allow popups for this site to open the editor.</p>
    <div id="issue-submission">
        <h3>Report an Issue</h3>
        <form id="issue-form">
            <input type="text" id="issue-title" placeholder="Issue Title" required>
            <textarea id="issue-body" placeholder="Describe the issue" required></textarea>
            <button type="submit">Submit Issue</button>
        </form>
        <p id="issue-feedback" style="display:none;"></p>
    </div>
    <div class="version-legend">Version 1.0.1</div>
    <script>
        // Existing issue submission script
        document.getElementById('issue-form').addEventListener('submit', (e) => {
            e.preventDefault();
            const title = document.getElementById('issue-title').value;
            const body = document.getElementById('issue-body').value;
            const feedback = document.getElementById('issue-feedback');
            try {
                const mailtoLink = `mailto:markscheitrum@aol.com?subject=${encodeURIComponent('Genealogy Recorder Issue: ' + title)}&body=${encodeURIComponent(body + '\n\nSent from Genealogy Recorder index.html')}`;
                window.location.href = mailtoLink;
                feedback.style.display = 'block';
                feedback.style.color = 'green';
                feedback.textContent = 'Your email client should have opened. Please attach any relevant files and send. If no email opened, manually email markscheitrum@aol.com with the issue details.';
                document.getElementById('issue-form').reset();
            } catch (err) {
                feedback.style.display = 'block';
                feedback.style.color = 'red';
                feedback.textContent = 'Failed to open email client. Please manually email markscheitrum@aol.com with the issue title and description.';
                console.error('Mailto error:', err);
            }
        });

        // Script to prevent duplicate editor windows
        let editorWindow = null; // Store reference to editor window
        document.getElementById('openEditorLink').addEventListener('click', function(e) {
            e.preventDefault(); // Prevent default link behavior
            if (editorWindow && !editorWindow.closed) {
                // If window exists and isn't closed, focus it
                editorWindow.focus();
            } else {
                // Dynamically calculate size: ~80% of available screen, min 800x600
                const availWidth = screen.availWidth || screen.width;
                const availHeight = screen.availHeight || screen.height;
                const width = Math.max(800, Math.min(1600, Math.floor(availWidth * 0.8)));
                const height = Math.max(600, Math.min(900, Math.floor(availHeight * 0.8)));
                // Open new window and store reference
                editorWindow = window.open('recorder4.html', 'genealogyEditor', `width=${width},height=${height}`);
                if (!editorWindow) {
                    // Show warning if popup is blocked
                    document.getElementById('popupWarning').style.display = 'block';
                }
            }
        });
    </script>
</body>
</html>




